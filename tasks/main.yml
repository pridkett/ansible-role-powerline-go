---
- name: Install Go Dependencies (apt)
  apt:
    name: golang-go
    state: present
    update_cache: true
  become: yes
  when: ansible_facts['os_family'] == "Debian"

- name: Install Go Dependencies (homebrew)
  homebrew:
    name: golang
    state: present
  when: ansible_facts['os_family'] == "Darwin"
  
- name: Install powerline-go
  command: go get -u github.com/justjanne/powerline-go
  environment:
    GOPATH: "{{ ansible_env.HOME }}/go"
  args:
    creates: "{{ ansible_env.HOME }}/go/bin/powerline-go"

- name: Install fish shell support
  template:
    src: powerline-go.fish.j2
    dest: "{{ fish_shell_script_path }}"
  when: powerline_go.install_fish is defined and powerline_go.install_fish == True
  tags: configure

- name: Install powerline-go zsh support
  template:
    src: powerline-go.zsh.j2
    dest: "{{ zsh_shell_script_path }}"
  when: powerline_go.install_zsh is defined and powerline_go.install_zsh == True
  tags: configure